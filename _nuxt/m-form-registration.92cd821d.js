import{r as v,s as B,x as W,j as b,o as c,c as m,t as _,e as S,a as g,y as z,z as G,u as i,A as V,n as k,B as I,m as H,l as R,h as q,d as h,w as D,C as N,q as L,D as E,E as J,G as K}from"./entry.a79d38f2.js";import{u as Z}from"./user.cf91f0ac.js";const Q=decodeURIComponent,X=encodeURIComponent,Y=/; */,C=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function ee(e,r){if(typeof e!="string")throw new TypeError("argument str must be a string");let o={},a=r||{},u=e.split(Y),l=a.decode||Q;for(let t=0;t<u.length;t++){let n=u[t],d=n.indexOf("=");if(d<0)continue;let f=n.substr(0,d).trim(),y=n.substr(++d,n.length).trim();y[0]=='"'&&(y=y.slice(1,-1)),o[f]==null&&(o[f]=te(y,l))}return o}function F(e,r,o){let a=o||{},u=a.encode||X;if(typeof u!="function")throw new TypeError("option encode is invalid");if(!C.test(e))throw new TypeError("argument name is invalid");let l=u(r);if(l&&!C.test(l))throw new TypeError("argument val is invalid");let t=e+"="+l;if(a.maxAge!=null){let n=a.maxAge-0;if(isNaN(n)||!isFinite(n))throw new TypeError("option maxAge is invalid");t+="; Max-Age="+Math.floor(n)}if(a.domain){if(!C.test(a.domain))throw new TypeError("option domain is invalid");t+="; Domain="+a.domain}if(a.path){if(!C.test(a.path))throw new TypeError("option path is invalid");t+="; Path="+a.path}if(a.expires){if(typeof a.expires.toUTCString!="function")throw new TypeError("option expires is invalid");t+="; Expires="+a.expires.toUTCString()}if(a.httpOnly&&(t+="; HttpOnly"),a.secure&&(t+="; Secure"),a.sameSite)switch(typeof a.sameSite=="string"?a.sameSite.toLowerCase():a.sameSite){case!0:t+="; SameSite=Strict";break;case"lax":t+="; SameSite=Lax";break;case"strict":t+="; SameSite=Strict";break;case"none":t+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return t}function te(e,r){try{return r(e)}catch{return e}}const ae={path:"/",watch:!0,decode:e=>W(decodeURIComponent(e)),encode:e=>encodeURIComponent(typeof e=="string"?e:JSON.stringify(e))};function M(e,r){var l;const o={...ae,...r},a=oe(o)||{},u=v(a[e]??((l=o.default)==null?void 0:l.call(o)));{const t=()=>{re(e,u.value,o)};o.watch?B(u,t,{deep:o.watch!=="shallow"}):t()}return u}function oe(e={}){return ee(document.cookie,e)}function ne(e,r,o={}){return r==null?F(e,r,{...o,maxAge:-1}):F(e,r,o)}function re(e,r,o={}){document.cookie=ne(e,r,o)}const se=["for"],ie={class:"a-input__container"},le={key:0},de=["placeholder","disabled"],ue=["type","placeholder","disabled"],j={__name:"a-input",props:{modelValue:{type:String,default:""},label:{type:String,default:""},type:{type:String,default:"text"},disabled:{type:Boolean,required:!1},placeholder:{type:String,default:""},size:{type:String,validator(e){return["large","medium","small"].indexOf(e)!==-1},default:"medium"}},emits:["update:modelValue"],setup(e,{emit:r}){const o=e,a=b(()=>({"a-input":!0,[`a-input--${o.size}`]:!0,["a-input--search"]:o.type==="search"})),u=b(()=>({[`a-input__textfield--${o.size}`]:!0,["a-input__textfield--search"]:o.type==="search"})),l=b({get(){return o.modelValue},set(t){r("update:modelValue",t)}});return(t,n)=>(c(),m("div",{class:k(["a-input",i(a)])},[e.label?(c(),m("label",{key:0,for:t.attrs.id},_(e.label),9,se)):S("",!0),g("div",ie,[e.type=="textarea"?(c(),m("textarea",le)):e.type=="search"?z((c(),m("input",{key:1,ref:"a-input","onUpdate:modelValue":n[0]||(n[0]=d=>V(l)?l.value=d:null),class:k(["a-input__textfield",i(u)]),type:"text",placeholder:e.placeholder,disabled:e.disabled},null,10,de)),[[G,i(l)]]):z((c(),m("input",{key:2,ref:"a-input","onUpdate:modelValue":n[1]||(n[1]=d=>V(l)?l.value=d:null),class:k(["a-input__textfield",i(u)]),type:e.type,placeholder:e.placeholder,disabled:e.disabled},null,10,ue)),[[I,i(l)]])])],2))}};const ce=["disabled","area-label"],me=["src"],pe={key:1,class:"a-button__label"},O={__name:"a-button",props:{label:{type:String,default:""},disabled:{type:Boolean,required:!1},iconLink:{type:String,default:"",required:!1},block:{type:Boolean,default:!1},size:{type:String,validator(e){return["xlarge","large","medium","small"].indexOf(e)!==-1},default:"medium"},type:{type:String,validator(e){return["primary","secondary","tertiary","accent","outline","outline-grey","outline-secondary","icon"].indexOf(e)!==-1},default:"primary"},width:{type:String,default:"",required:!1}},setup(e){const r=e,o=b(()=>({[`a-button--${r.size}`]:!0,[`a-button--${r.type}`]:!0,"a-button--disabled":r.disabled,"a-button--block":r.block})),a=b(()=>r.iconLink&&r.iconLink.length);return(u,l)=>(c(),m("button",{class:k(["a-button",i(o)]),type:"button",disabled:e.disabled,style:H([`width: ${e.width};`]),role:"button","area-label":e.label},[i(a)?(c(),m("img",{key:0,src:e.iconLink,alt:"",class:"a-button__icon"},null,8,me)):S("",!0),i(a)?S("",!0):(c(),m("span",pe,_(e.label),1))],14,ce))}};const fe={class:"a-control"},ye=["type","checked","disabled"],he={class:"a-control__container"},be={__name:"a-control",props:{text:{type:String,default:""},typeControl:{type:String,validator(e){return["checkbox","radio"].indexOf(e)!==-1},default:"checkbox"},checked:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},modelValue:{type:Boolean,default:!1},textType:{type:String,validator(e){return["primary","contrast"].indexOf(e)!==-1},default:"primary"}},emits:["update:modelValue"],setup(e,{emit:r}){const o=e,a=b({get(){return o.modelValue},set(t){r("update:modelValue",t)}}),u=b(()=>({"a-control__trigger--checked":a.value})),l=b(()=>({[`a-control__text--${o.textType}`]:!0}));return(t,n)=>(c(),m("label",fe,[z(g("input",{"onUpdate:modelValue":n[0]||(n[0]=d=>V(a)?a.value=d:null),class:"a-control__input",type:e.typeControl,checked:e.checked,disabled:e.disabled,onChange:n[1]||(n[1]=(...d)=>t.handleChange&&t.handleChange(...d)),onClick:n[2]||(n[2]=(...d)=>t.handleClick&&t.handleClick(...d))},null,40,ye),[[I,i(a)]]),g("div",he,[g("div",{class:k(["a-control__trigger",i(u)])},null,2),e.text||t.$slots.default?(c(),m("div",{key:0,class:k(["a-control__text",i(l)])},[R(t.$slots,"default",{},()=>[q(_(e.text),1)])],2)):S("",!0)])]))}};const _e={class:"m-form"},ge={key:0,class:"m-form__title"},we={class:"m-form__checkbox"},ke={key:1,class:"m-form__error"},P={__name:"m-form",props:{title:{type:String,default:""},error:{type:String,default:""},buttonText:{type:String,default:"Отправить"},submitDisabled:{type:Boolean,default:!0},direction:{type:String,default:"vertical"},formOptions:{type:Object,required:!1,default(){return{type:"accent"}}}},emits:["onSubmit"],setup(e,{emit:r}){const o=e,a=v(!0),u=()=>{r("onSubmit")},l=b(()=>!a.value||o.submitDisabled),t=b(()=>({[`m-form__inputs--${o.direction}`]:!0}));return(n,d)=>{const f=O,y=be;return c(),m("div",_e,[e.title?(c(),m("div",ge,_(e.title),1)):S("",!0),g("div",{class:k(["m-form__inputs",i(t)])},[R(n.$slots,"inputs"),h(f,{class:"m-form__button",type:e.formOptions.type,label:e.buttonText,disabled:i(l),onClick:u},null,8,["type","label","disabled"])],2),g("div",we,[h(y,{modelValue:i(a),"onUpdate:modelValue":d[0]||(d[0]=x=>V(a)?a.value=x:null),"text-type":e.formOptions.type},{default:D(()=>[q(_(n.$t("form.confirm")),1)]),_:1},8,["modelValue","text-type"])]),e.error?(c(),m("p",ke,"- "+_(e.error)+" -",1)):S("",!0)])}}},ve={class:"section-form"},Se={class:"m-form__direction"},Ee={__name:"m-form-login",emits:["onSend","formBtnClick"],setup(e,{emit:r}){const o=Z(),a=N(),u=L(),l=M("userInformation",{default:()=>[],watch:"shallow"});let t=E({email:"",password:""}),n=E({email:!0,password:!0}),d=v(!1),f=v("");const y=()=>(n.email=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/i.test(t.email),n.password=/^([A-Z,0-9][-,a-z,0-9']+[ ]*)+$/i.test(t.password)&&t.password.length>5,n.email&&n.password),x=()=>{r("formBtnClick","registration")};B(t,()=>{d.value=y()},{immediate:!0});async function U(){if(d)try{const{user:s}=await J(a.$auth,t.email,t.password);u.currentRoute.value.name==="authorization"?u.push({path:"/presentation"}):u.push({path:"/information"}),r("onSend"),o.setUser(s.email,s.uid);const p={email:s.email,id:s.uid,maxAge:60*60*24*7};l.value=p}catch(s){s.message==="Firebase: Error (auth/email-already-in-use)."?f.value="Пользователь уже зарегистрирован.":s.message==="Firebase: Error (auth/wrong-password)."?f.value="Неверно указан пароль.":s.message==="Firebase: Error (auth/user-not-found)."&&(f.value="Пользователь не найден.")}}return(s,p)=>{const $=j,A=P,T=O;return c(),m("section",ve,[h(A,{title:s.$t("form.login"),"button-text":s.$t("form.login"),"submit-disabled":!i(d),error:i(f),onOnSubmit:U},{inputs:D(()=>[h($,{id:"popup-form-email",modelValue:i(t).email,"onUpdate:modelValue":p[0]||(p[0]=w=>i(t).email=w),placeholder:s.$t("form.email")},null,8,["modelValue","placeholder"]),h($,{id:"popup-form-password",modelValue:i(t).password,"onUpdate:modelValue":p[1]||(p[1]=w=>i(t).password=w),type:"password",placeholder:s.$t("form.password")},null,8,["modelValue","placeholder"])]),_:1},8,["title","button-text","submit-disabled","error"]),g("p",Se,"- "+_(s.$t("form.or"))+" -",1),h(T,{class:"m-form__change",label:s.$t("form.registration"),onClick:x},null,8,["label"])])}}},xe={class:"section-form"},$e={class:"m-form__direction"},Ue={__name:"m-form-registration",emits:["onSend","formBtnClick"],setup(e,{emit:r}){const o=Z(),a=N(),u=L(),l=M("userInformation",{default:()=>[],watch:"shallow"});let t=E({email:"",password:""}),n=E({email:!0,password:!0}),d=v(!1),f=v("");const y=()=>(n.email=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/i.test(t.email),n.password=/^([A-Z,0-9][-,a-z,0-9']+[ ]*)+$/i.test(t.password)&&t.password.length>5,n.email&&n.password);B(t,()=>{d.value=y()},{immediate:!0});const x=()=>{r("formBtnClick","login")};async function U(){if(d)try{const{user:s}=await K(a.$auth,t.email,t.password);u.push({path:"/information"}),r("onSend"),o.setUser(s.email,s.uid);const p={email:s.email,id:s.uid,maxAge:60*60*24*7,SameSite:Lax};l.value=p}catch(s){s.message==="Firebase: Error (auth/email-already-in-use)."&&(f.value="Пользователь уже зарегистрирован.")}}return(s,p)=>{const $=j,A=P,T=O;return c(),m("section",xe,[h(A,{title:s.$t("form.registration"),"button-text":s.$t("form.registration"),"submit-disabled":!i(d),error:i(f),onOnSubmit:U},{inputs:D(()=>[h($,{id:"popup-form-email",modelValue:i(t).email,"onUpdate:modelValue":p[0]||(p[0]=w=>i(t).email=w),placeholder:s.$t("form.email")},null,8,["modelValue","placeholder"]),h($,{id:"popup-form-password",modelValue:i(t).password,"onUpdate:modelValue":p[1]||(p[1]=w=>i(t).password=w),placeholder:s.$t("form.password"),type:"password"},null,8,["modelValue","placeholder"])]),_:1},8,["title","button-text","submit-disabled","error"]),g("p",$e,"- "+_(s.$t("form.or"))+" -",1),h(T,{class:"m-form__change",label:s.$t("form.login"),onClick:x},null,8,["label"])])}}};export{Ee as _,Ue as a,M as u};
