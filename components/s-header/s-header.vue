<template>
  <header class="header" :class="[{ invisible: isScrolled }]">
    <div class="container header__container">
      <div class="header__logo">
        <nuxt-link to="/">
          <!-- <img src="@/assets/images/header/logo.png" alt="logo" /> -->
          <svg
            width="100"
            height="100"
            viewBox="0 0 100 100"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
            class="header__logo-pic"
          >
            <circle cx="50" cy="50" r="50" fill="#FDFF85" />
            <path
              d="M23.76 60H23.36C22.6667 60 22 59.9333 21.36 59.8C20.72 59.6667 20.1467 59.4267 19.64 59.08C19.16 58.7333 18.76 58.2533 18.44 57.64C18.1467 57.0267 18 56.2267 18 55.24V30.96H18.64C19.28 30.96 19.9067 31.04 20.52 31.2C21.1333 31.3333 21.68 31.5867 22.16 31.96C22.64 32.3067 23.0267 32.7867 23.32 33.4C23.6133 34.0133 23.76 34.8 23.76 35.76V60ZM32.52 56.16C32.52 56.6133 32.4267 57.0667 32.24 57.52C32.08 57.9733 31.8267 58.3867 31.48 58.76C31.16 59.1067 30.7333 59.4 30.2 59.64C29.6933 59.88 29.1067 60 28.44 60H28.28C27.56 60 26.96 59.88 26.48 59.64C26 59.3733 25.6 59.0667 25.28 58.72C24.9867 58.3467 24.7733 57.96 24.64 57.56C24.5333 57.1333 24.48 56.76 24.48 56.44C24.48 56.2267 24.48 56.04 24.48 55.88C24.5067 55.6933 24.56 55.4933 24.64 55.28C24.9867 55.6 25.4133 55.76 25.92 55.76C26.32 55.76 26.6533 55.64 26.92 55.4C27.1867 55.1333 27.32 54.7467 27.32 54.24V52.28C27.3733 52.2533 27.5467 52.24 27.84 52.24C28.16 52.2133 28.4133 52.2 28.6 52.2C28.8933 52.2 29.2667 52.2533 29.72 52.36C30.1733 52.44 30.6 52.6267 31 52.92C31.4267 53.2133 31.7867 53.6267 32.08 54.16C32.3733 54.6667 32.52 55.3333 32.52 56.16ZM40.4647 53.76C40.4647 54.08 40.478 54.3867 40.5047 54.68C40.558 54.9733 40.638 55.24 40.7447 55.48C40.878 55.6933 41.0514 55.88 41.2647 56.04C41.5047 56.1733 41.8247 56.24 42.2247 56.24C42.438 56.24 42.6514 56.2133 42.8647 56.16C43.1047 56.08 43.318 55.96 43.5047 55.8C43.6114 56.0133 43.678 56.2267 43.7047 56.44C43.7314 56.6267 43.7447 56.8267 43.7447 57.04C43.7447 57.8933 43.3847 58.6 42.6647 59.16C41.9447 59.72 41.078 60 40.0647 60C38.4647 60 37.238 59.5733 36.3847 58.72C35.5314 57.8667 35.1047 56.8 35.1047 55.52V44.4C35.1047 43.52 35.2647 42.7867 35.5847 42.2C35.9314 41.5867 36.358 41.0933 36.8647 40.72C37.398 40.3467 37.9714 40.08 38.5847 39.92C39.2247 39.76 39.8514 39.68 40.4647 39.68V53.76ZM49.5847 55.28C49.5847 56.2133 49.4114 56.9867 49.0647 57.6C48.7447 58.1867 48.318 58.6667 47.7847 59.04C47.278 59.3867 46.7047 59.64 46.0647 59.8C45.4247 59.9333 44.8114 60 44.2247 60V45.92C44.2247 45.6 44.198 45.2933 44.1447 45C44.118 44.7067 44.038 44.4533 43.9047 44.24C43.798 44 43.6247 43.8133 43.3847 43.68C43.1714 43.52 42.8647 43.44 42.4647 43.44C42.2514 43.44 42.0247 43.48 41.7847 43.56C41.5714 43.6133 41.3714 43.72 41.1847 43.88C41.078 43.6667 41.0114 43.4667 40.9847 43.28C40.958 43.0667 40.9447 42.8533 40.9447 42.64C40.9447 41.7867 41.3047 41.08 42.0247 40.52C42.7447 39.96 43.6114 39.68 44.6247 39.68C46.2247 39.68 47.4514 40.0933 48.3047 40.92C49.158 41.72 49.5847 42.88 49.5847 44.4V55.28ZM58.5506 53.76C58.5506 54.08 58.564 54.3867 58.5906 54.68C58.644 54.9733 58.724 55.24 58.8306 55.48C58.964 55.6933 59.1373 55.88 59.3506 56.04C59.5906 56.1733 59.9106 56.24 60.3106 56.24C60.524 56.24 60.7373 56.2133 60.9506 56.16C61.1906 56.08 61.404 55.96 61.5906 55.8C61.6973 56.0133 61.764 56.2267 61.7906 56.44C61.8173 56.6267 61.8306 56.8267 61.8306 57.04C61.8306 57.8933 61.4706 58.6 60.7506 59.16C60.0306 59.72 59.164 60 58.1506 60C56.5506 60 55.324 59.5733 54.4706 58.72C53.6173 57.8667 53.1906 56.8 53.1906 55.52V44.4C53.1906 43.52 53.3506 42.7867 53.6706 42.2C54.0173 41.5867 54.444 41.0933 54.9506 40.72C55.484 40.3467 56.0573 40.08 56.6706 39.92C57.3106 39.76 57.9373 39.68 58.5506 39.68V53.76ZM62.3106 45.92C62.3106 45.6 62.284 45.2933 62.2306 45C62.204 44.7067 62.124 44.4533 61.9906 44.24C61.884 44 61.7106 43.8133 61.4706 43.68C61.2573 43.52 60.9506 43.44 60.5506 43.44C60.3373 43.44 60.1106 43.48 59.8706 43.56C59.6573 43.6133 59.4573 43.72 59.2706 43.88C59.164 43.6667 59.0973 43.4667 59.0706 43.28C59.044 43.0667 59.0306 42.8533 59.0306 42.64C59.0306 41.7867 59.3906 41.08 60.1106 40.52C60.8306 39.96 61.6973 39.68 62.7106 39.68C64.3106 39.68 65.5373 40.0933 66.3906 40.92C67.244 41.72 67.6706 42.88 67.6706 44.4V60.84C67.6706 61.5333 67.5106 62.16 67.1906 62.72C66.8973 63.3067 66.4973 63.8133 65.9906 64.24C65.484 64.6667 64.9106 65 64.2706 65.24C63.6306 65.48 62.9773 65.6 62.3106 65.6V45.92ZM55.8306 67.12C55.8306 66.2933 55.9906 65.6133 56.3106 65.08C56.6306 64.5733 57.0173 64.1733 57.4706 63.88C57.924 63.5867 58.404 63.3867 58.9106 63.28C59.4173 63.2 59.8573 63.16 60.2306 63.16C60.5506 63.16 60.8173 63.1867 61.0306 63.24V65.08C61.0306 65.64 61.164 66.0533 61.4306 66.32C61.6973 66.5867 62.0306 66.72 62.4306 66.72C62.9106 66.72 63.3373 66.56 63.7106 66.24C63.7906 66.4533 63.8306 66.64 63.8306 66.8C63.8573 66.9867 63.8706 67.1867 63.8706 67.4C63.8706 67.72 63.7906 68.08 63.6306 68.48C63.4973 68.9067 63.2706 69.2933 62.9506 69.64C62.6573 70.0133 62.2573 70.32 61.7506 70.56C61.2706 70.8267 60.684 70.96 59.9906 70.96C59.2706 70.96 58.644 70.84 58.1106 70.6C57.604 70.36 57.1773 70.0533 56.8306 69.68C56.5106 69.3333 56.2573 68.9333 56.0706 68.48C55.9106 68.0267 55.8306 67.5733 55.8306 67.12ZM76.6366 53.76C76.6366 54.08 76.6499 54.3867 76.6766 54.68C76.7299 54.9733 76.8099 55.24 76.9166 55.48C77.0499 55.6933 77.2232 55.88 77.4366 56.04C77.6766 56.1733 77.9966 56.24 78.3966 56.24C78.6099 56.24 78.8232 56.2133 79.0366 56.16C79.2766 56.08 79.4899 55.96 79.6766 55.8C79.7832 56.0133 79.8499 56.2267 79.8766 56.44C79.9032 56.6267 79.9166 56.8267 79.9166 57.04C79.9166 57.8933 79.5566 58.6 78.8366 59.16C78.1166 59.72 77.2499 60 76.2366 60C74.6366 60 73.4099 59.5733 72.5566 58.72C71.7032 57.8667 71.2766 56.8 71.2766 55.52V44.4C71.2766 43.52 71.4366 42.7867 71.7566 42.2C72.1032 41.5867 72.5299 41.0933 73.0366 40.72C73.5699 40.3467 74.1432 40.08 74.7566 39.92C75.3966 39.76 76.0232 39.68 76.6366 39.68V53.76ZM85.7566 55.28C85.7566 56.2133 85.5832 56.9867 85.2366 57.6C84.9166 58.1867 84.4899 58.6667 83.9566 59.04C83.4499 59.3867 82.8766 59.64 82.2366 59.8C81.5966 59.9333 80.9832 60 80.3966 60V45.92C80.3966 45.6 80.3699 45.2933 80.3166 45C80.2899 44.7067 80.2099 44.4533 80.0766 44.24C79.9699 44 79.7966 43.8133 79.5566 43.68C79.3432 43.52 79.0366 43.44 78.6366 43.44C78.4232 43.44 78.1966 43.48 77.9566 43.56C77.7432 43.6133 77.5432 43.72 77.3566 43.88C77.2499 43.6667 77.1832 43.4667 77.1566 43.28C77.1299 43.0667 77.1166 42.8533 77.1166 42.64C77.1166 41.7867 77.4766 41.08 78.1966 40.52C78.9166 39.96 79.7832 39.68 80.7966 39.68C82.3966 39.68 83.6232 40.0933 84.4766 40.92C85.3299 41.72 85.7566 42.88 85.7566 44.4V55.28Z"
              fill="black"
            />
          </svg>
        </nuxt-link>
      </div>
      <!-- {{ $tm("menu") }} -->
      <div class="header__menu" :class="[{ open: isActiveBurger }]">
        <m-menu :items="menuItems" />
      </div>
      <button type="button" @click="clickBurger" v-if="isMobileView" class="header__burger">
        <svg
          class="ham hamRotate hamR"
          :class="[{ active: isActiveBurger }]"
          viewBox="0 0 100 100"
          width="40"
          ref="ham"
        >
          <path
            class="line top"
            d="m 70,33 h -40 c 0,0 -8.5,-0.149796 -8.5,8.5 0,8.649796 8.5,8.5 8.5,8.5 h 20 v -20"
          />
          <path class="line middle" d="m 70,50 h -40" />
          <path
            class="line bottom"
            d="m 30,67 h 40 c 0,0 8.5,0.149796 8.5,-8.5 0,-8.649796 -8.5,-8.5 -8.5,-8.5 h -20 v 20"
          />
        </svg>
      </button>
      <div class="header__actions" v-if="!isMobileView">
        <button @click="changeLanguage($i18n)" class="header__lang header__btn" type="button">
          {{ $t('header.language') }}
        </button>
        <button @click="changeThemes" class="header__themes header__btn" type="button">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g clip-path="url(#clip0_578_178)">
              <path
                class="header__themes--dark"
                d="M12 18C10.4087 18 8.88258 17.3679 7.75736 16.2426C6.63214 15.1174 6 13.5913 6 12C6 10.4087 6.63214 8.88258 7.75736 7.75736C8.88258 6.63214 10.4087 6 12 6C13.5913 6 15.1174 6.63214 16.2426 7.75736C17.3679 8.88258 18 10.4087 18 12C18 13.5913 17.3679 15.1174 16.2426 16.2426C15.1174 17.3679 13.5913 18 12 18ZM11 1H13V4H11V1ZM11 20H13V23H11V20ZM3.515 4.929L4.929 3.515L7.05 5.636L5.636 7.05L3.515 4.93V4.929ZM16.95 18.364L18.364 16.95L20.485 19.071L19.071 20.485L16.95 18.364ZM19.071 3.514L20.485 4.929L18.364 7.05L16.95 5.636L19.071 3.515V3.514ZM5.636 16.95L7.05 18.364L4.929 20.485L3.515 19.071L5.636 16.95ZM23 11V13H20V11H23ZM4 11V13H1V11H4Z"
                fill="white"
              />
            </g>
            <defs>
              <clipPath id="clip0_578_178">
                <rect width="24" height="24" fill="white" />
              </clipPath>
            </defs>
          </svg>
        </button>
      </div>
    </div>

    <a-popup :visible="showPopup" @close="showPopup = false" class="s-header__popup">
      <m-form-popup title="Оставь заявку " />
    </a-popup>
  </header>
</template>

<script setup>
import './s-header.scss';
import { ref, onMounted } from 'vue';

const emit = defineEmits(['handler-change-themes']);
// eslint-disable-next-line no-unused-vars
const props = defineProps({
  isMobileView: {
    type: Boolean,
    required: true,
  },
});

const isScrolled = ref(false);
const isActiveBurger = ref(false);

// const menuItems = $tm("menu");

const menuItems = ref([
  {
    name: 'index',
    anchor: 'Страница 1',
    link: '/',
  },
  {
    name: 'test',
    anchor: 'Страница 2',
    link: '/test',
  },
  {
    name: 'test',
    anchor: 'Якорь',
    link: '#test',
  },
]);

// eslint-disable-next-line no-unused-vars
const scrollPage = () => {
  let scrollPrev = 0;
  window.addEventListener('scroll', () => {
    const scrolled = window.scrollY;
    if (scrolled > 80 && scrolled > scrollPrev) {
      isScrolled.value = true;
    } else {
      isScrolled.value = false;
    }
    scrollPrev = scrolled;
  });
};

// eslint-disable-next-line no-unused-vars
const changeThemes = (event) => {
  emit('handler-change-themes', event);
};

const clickBurger = () => {
  isActiveBurger.value = !isActiveBurger.value;
};

// eslint-disable-next-line no-unused-vars
const changeLanguage = (lang) => {
  // eslint-disable-next-line no-param-reassign
  lang.locale = lang.locale === 'ru' ? 'en' : 'ru';
};

onMounted(() => {
  scrollPage();
});
</script>
